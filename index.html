<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n l√Ω m√°y t√≠nh ph√≤ng h·ªçp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .computer-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .computer-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .computer-card:hover::before {
            transform: scaleX(1);
        }

        .computer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .computer-card.available {
            border-color: #28a745;
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
        }

        .computer-card.in-use {
            border-color: #dc3545;
            background: linear-gradient(145deg, #f8d7da, #f5c6cb);
        }

        .computer-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-available {
            background: #28a745;
            color: white;
        }

        .status-in-use {
            background: #dc3545;
            color: white;
        }

        .form-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #007bff;
        }

        .form-section h3 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,123,255,0.2);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .history-section {
            margin-top: 40px;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .history-table th {
            background: linear-gradient(135deg, #343a40, #495057);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .history-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .history-table tr:hover {
            background: #f8f9fa;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-color: #28a745;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-color: #dc3545;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .current-time {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .status-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="current-time" id="currentTime"></div>
    
    <div class="container">
        <div class="header">
            <h1>üñ•Ô∏è Qu·∫£n l√Ω m√°y t√≠nh ph√≤ng h·ªçp</h1>
            <p>H·ªá th·ªëng theo d√µi v√† qu·∫£n l√Ω vi·ªác s·ª≠ d·ª•ng m√°y t√≠nh</p>
        </div>

        <div class="main-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalBorrows">0</div>
                    <div>T·ªïng l∆∞·ª£t m∆∞·ª£n</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="availableCount">2</div>
                    <div>M√°y kh·∫£ d·ª•ng</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="inUseCount">0</div>
                    <div>ƒêang s·ª≠ d·ª•ng</div>
                </div>
            </div>

            <div class="status-grid">
                <div class="computer-card available" id="computer1">
                    <div class="computer-title">
                        üíª M√°y t√≠nh #1
                        <span class="status-badge status-available">S·∫µn s√†ng</span>
                    </div>
                    <div id="computer1-info">
                        <p><strong>Tr·∫°ng th√°i:</strong> C√≥ th·ªÉ s·ª≠ d·ª•ng</p>
                        <p><strong>Ng∆∞·ªùi d√πng:</strong> Kh√¥ng c√≥</p>
                        <p><strong>Th·ªùi gian:</strong> --</p>
                    </div>
                </div>

                <div class="computer-card available" id="computer2">
                    <div class="computer-title">
                        üñ•Ô∏è M√°y t√≠nh #2
                        <span class="status-badge status-available">S·∫µn s√†ng</span>
                    </div>
                    <div id="computer2-info">
                        <p><strong>Tr·∫°ng th√°i:</strong> C√≥ th·ªÉ s·ª≠ d·ª•ng</p>
                        <p><strong>Ng∆∞·ªùi d√πng:</strong> Kh√¥ng c√≥</p>
                        <p><strong>Th·ªùi gian:</strong> --</p>
                    </div>
                </div>
            </div>

            <div id="alertContainer"></div>

            <div class="form-section">
                <h3>üìù M∆∞·ª£n m√°y t√≠nh</h3>
                <form id="borrowForm">
                    <div class="form-group">
                        <label for="computerSelect">Ch·ªçn m√°y t√≠nh:</label>
                        <select id="computerSelect" class="form-control" required>
                            <option value="">-- Ch·ªçn m√°y t√≠nh --</option>
                            <option value="1">M√°y t√≠nh #1</option>
                            <option value="2">M√°y t√≠nh #2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="borrowerName">H·ªç t√™n ng∆∞·ªùi m∆∞·ª£n:</label>
                        <input type="text" id="borrowerName" class="form-control" required placeholder="Nh·∫≠p h·ªç t√™n ƒë·∫ßy ƒë·ªß">
                    </div>
                    <div class="form-group">
                        <label for="borrowerDepartment">Ph√≤ng ban:</label>
                        <input type="text" id="borrowerDepartment" class="form-control" required placeholder="Nh·∫≠p t√™n ph√≤ng ban">
                    </div>
                    <div class="form-group">
                        <label for="purpose">M·ª•c ƒë√≠ch s·ª≠ d·ª•ng:</label>
                        <textarea id="purpose" class="form-control" rows="3" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn m·ª•c ƒë√≠ch s·ª≠ d·ª•ng"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">üîí M∆∞·ª£n m√°y t√≠nh</button>
                </form>
            </div>

            <div class="form-section">
                <h3>üì§ Tr·∫£ m√°y t√≠nh</h3>
                <form id="returnForm">
                    <div class="form-group">
                        <label for="returnComputerSelect">Ch·ªçn m√°y t√≠nh c·∫ßn tr·∫£:</label>
                        <select id="returnComputerSelect" class="form-control" required>
                            <option value="">-- Ch·ªçn m√°y t√≠nh --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="returnNotes">Ghi ch√∫ (t√πy ch·ªçn):</label>
                        <textarea id="returnNotes" class="form-control" rows="2" placeholder="Ghi ch√∫ t√¨nh tr·∫°ng m√°y t√≠nh khi tr·∫£"></textarea>
                    </div>
                    <button type="submit" class="btn btn-success">‚úÖ Tr·∫£ m√°y t√≠nh</button>
                </form>
            </div>

            <div class="form-section">
                <h3>‚öôÔ∏è Qu·∫£n l√Ω d·ªØ li·ªáu</h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                    <button type="button" class="btn btn-primary" onclick="exportData()" title="T·∫£i d·ªØ li·ªáu v·ªÅ m√°y">
                        üíæ Xu·∫•t d·ªØ li·ªáu
                    </button>
                    <button type="button" class="btn btn-success" onclick="resetData()" title="Kh√¥i ph·ª•c d·ªØ li·ªáu m·∫´u">
                        üîÑ Reset d·ªØ li·ªáu m·∫´u
                    </button>
                    <span style="color: #6c757d; font-size: 0.9em;">
                        üí° D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông khi c√≥ thay ƒë·ªïi
                    </span>
                </div>
            </div>
                <form id="returnForm">
                    <div class="form-group">
                        <label for="returnComputerSelect">Ch·ªçn m√°y t√≠nh c·∫ßn tr·∫£:</label>
                        <select id="returnComputerSelect" class="form-control" required>
                            <option value="">-- Ch·ªçn m√°y t√≠nh --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="returnNotes">Ghi ch√∫ (t√πy ch·ªçn):</label>
                        <textarea id="returnNotes" class="form-control" rows="2" placeholder="Ghi ch√∫ t√¨nh tr·∫°ng m√°y t√≠nh khi tr·∫£"></textarea>
                    </div>
                    <button type="submit" class="btn btn-success">‚úÖ Tr·∫£ m√°y t√≠nh</button>
                </form>
            </div>

            <div class="history-section">
                <h3>üìä L·ªãch s·ª≠ s·ª≠ d·ª•ng (10 l·∫ßn g·∫ßn nh·∫•t)</h3>
                <div style="background: #e7f3ff; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #007bff;">
                    <p><strong>üí° Th√¥ng tin:</strong> B·∫£ng d∆∞·ªõi ƒë√¢y hi·ªÉn th·ªã 10 l·∫ßn m∆∞·ª£n m√°y t√≠nh g·∫ßn nh·∫•t. C√°c b·∫£n ghi ƒëang s·ª≠ d·ª•ng ƒë∆∞·ª£c t√¥ s√°ng m√†u v√†ng.</p>
                </div>
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>M√°y t√≠nh</th>
                            <th>Ng∆∞·ªùi m∆∞·ª£n</th>
                            <th>Ph√≤ng ban</th>
                            <th>Th·ªùi gian m∆∞·ª£n</th>
                            <th>Th·ªùi gian tr·∫£</th>
                            <th>M·ª•c ƒë√≠ch</th>
                            <th>Tr·∫°ng th√°i</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- L·ªãch s·ª≠ s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu m√°y t√≠nh v·ªõi tr·∫°ng th√°i hi·ªán t·∫°i
        let defaultComputers = {
            1: { 
                available: false, 
                borrower: "Nguy·ªÖn VƒÉn Minh", 
                borrowTime: "01/07/2025 14:30:15", 
                purpose: "Chu·∫©n b·ªã thuy·∫øt tr√¨nh d·ª± √°n Q3", 
                department: "Ph√≤ng Kinh doanh" 
            },
            2: { 
                available: true, 
                borrower: null, 
                borrowTime: null, 
                purpose: null, 
                department: null 
            }
        };

        // L·ªãch s·ª≠ s·ª≠ d·ª•ng v·ªõi d·ªØ li·ªáu m·∫´u (15 b·∫£n ghi ƒë·ªÉ test)
        let defaultHistory = [
            {
                computerId: "1",
                borrower: "Tr·∫ßn Th·ªã Lan",
                department: "Ph√≤ng Nh√¢n s·ª±",
                borrowTime: "28/06/2025 09:15:30",
                returnTime: "28/06/2025 11:45:20",
                purpose: "T·∫°o b√°o c√°o tuy·ªÉn d·ª•ng th√°ng 6"
            },
            {
                computerId: "2",
                borrower: "L√™ VƒÉn ƒê·ª©c",
                department: "Ph√≤ng K·∫ø to√°n",
                borrowTime: "28/06/2025 13:20:10",
                returnTime: "28/06/2025 16:30:45",
                purpose: "L·∫≠p b√°o c√°o t√†i ch√≠nh"
            },
            {
                computerId: "1",
                borrower: "Ph·∫°m Th·ªã Mai",
                department: "Ph√≤ng Marketing",
                borrowTime: "29/06/2025 08:45:25",
                returnTime: "29/06/2025 12:15:10",
                purpose: "Thi·∫øt k·∫ø poster qu·∫£ng c√°o"
            },
            {
                computerId: "2",
                borrower: "Ho√†ng VƒÉn Nam",
                department: "Ph√≤ng IT",
                borrowTime: "29/06/2025 14:10:30",
                returnTime: "29/06/2025 17:20:15",
                purpose: "C·∫≠p nh·∫≠t h·ªá th·ªëng qu·∫£n l√Ω"
            },
            {
                computerId: "1",
                borrower: "V≈© Th·ªã Hoa",
                department: "Ph√≤ng H√†nh ch√≠nh",
                borrowTime: "30/06/2025 09:30:45",
                returnTime: "30/06/2025 11:15:20",
                purpose: "So·∫°n th·∫£o quy ƒë·ªãnh n·ªôi b·ªô"
            },
            {
                computerId: "2",
                borrower: "ƒê·ªó VƒÉn Tu·∫•n",
                department: "Ph√≤ng Kinh doanh",
                borrowTime: "30/06/2025 13:45:10",
                returnTime: "30/06/2025 15:30:25",
                purpose: "Chu·∫©n b·ªã b·∫£n demo s·∫£n ph·∫©m"
            },
            {
                computerId: "1",
                borrower: "Ng√¥ Th·ªã Linh",
                department: "Ph√≤ng K·∫ø to√°n",
                borrowTime: "30/06/2025 16:00:15",
                returnTime: "30/06/2025 18:45:30",
                purpose: "ƒê·ªëi so√°t c√¥ng n·ª£ cu·ªëi th√°ng"
            },
            {
                computerId: "2",
                borrower: "B√πi VƒÉn Khang",
                department: "Ph√≤ng Nh√¢n s·ª±",
                borrowTime: "01/07/2025 08:15:20",
                returnTime: "01/07/2025 10:30:45",
                purpose: "C·∫≠p nh·∫≠t h·ªì s∆° nh√¢n vi√™n"
            },
            {
                computerId: "1",
                borrower: "L√Ω Th·ªã Trang",
                department: "Ph√≤ng Marketing",
                borrowTime: "01/07/2025 11:20:10",
                returnTime: "01/07/2025 13:15:35",
                purpose: "Ch·ªânh s·ª≠a video qu·∫£ng c√°o"
            },
            {
                computerId: "2",
                borrower: "ƒêinh VƒÉn H√πng",
                department: "Ph√≤ng IT",
                borrowTime: "01/07/2025 13:45:25",
                returnTime: "01/07/2025 14:20:10",
                purpose: "Ki·ªÉm tra b·∫£o m·∫≠t h·ªá th·ªëng"
            },
            // B·∫£n ghi hi·ªán t·∫°i (ƒëang s·ª≠ d·ª•ng)
            {
                computerId: "1",
                borrower: "Nguy·ªÖn VƒÉn Minh",
                department: "Ph√≤ng Kinh doanh",
                borrowTime: "01/07/2025 14:30:15",
                returnTime: null,
                purpose: "Chu·∫©n b·ªã thuy·∫øt tr√¨nh d·ª± √°n Q3"
            },
            // Th√™m v√†i b·∫£n ghi c≈© h∆°n ƒë·ªÉ test vi·ªác gi·ªõi h·∫°n hi·ªÉn th·ªã
            {
                computerId: "2",
                borrower: "C≈© Test 1",
                department: "Test",
                borrowTime: "25/06/2025 10:00:00",
                returnTime: "25/06/2025 12:00:00",
                purpose: "Test c≈©"
            },
            {
                computerId: "1",
                borrower: "C≈© Test 2",
                department: "Test",
                borrowTime: "24/06/2025 10:00:00",
                returnTime: "24/06/2025 12:00:00",
                purpose: "Test c≈©"
            },
            {
                computerId: "2",
                borrower: "C≈© Test 3",
                department: "Test",
                borrowTime: "23/06/2025 10:00:00",
                returnTime: "23/06/2025 12:00:00",
                purpose: "Test c≈©"
            },
            {
                computerId: "1",
                borrower: "C≈© Test 4",
                department: "Test",
                borrowTime: "22/06/2025 10:00:00",
                returnTime: "22/06/2025 12:00:00",
                purpose: "Test c≈©"
            }
        ];

        // Kh·ªüi t·∫°o d·ªØ li·ªáu t·ª´ cache ho·∫∑c d·ªØ li·ªáu m·∫∑c ƒë·ªãnh
        let computers = loadData('computers') || defaultComputers;
        let history = loadData('history') || defaultHistory;
        let totalBorrows = loadData('totalBorrows') || defaultHistory.length;

        // H√†m l∆∞u d·ªØ li·ªáu v√†o b·ªô nh·ªõ tr√¨nh duy·ªát
        function saveData(key, data) {
            try {
                // S·ª≠ d·ª•ng sessionStorage thay v√¨ localStorage ƒë·ªÉ tr√°nh l·ªói
                const dataStr = JSON.stringify(data);
                
                // S·ª≠ d·ª•ng cookies l√†m backup
                document.cookie = `${key}=${encodeURIComponent(dataStr)}; path=/; max-age=86400`; // 24 gi·ªù
                
                // L∆∞u v√†o bi·∫øn to√†n c·ª•c ƒë·ªÉ backup
                window[`backup_${key}`] = data;
                
                return true;
            } catch (error) {
                console.warn('Kh√¥ng th·ªÉ l∆∞u d·ªØ li·ªáu:', error);
                return false;
            }
        }

        // H√†m t·∫£i d·ªØ li·ªáu t·ª´ b·ªô nh·ªõ tr√¨nh duy·ªát
        function loadData(key) {
            try {
                // Th·ª≠ t·∫£i t·ª´ bi·∫øn to√†n c·ª•c tr∆∞·ªõc
                if (window[`backup_${key}`]) {
                    return window[`backup_${key}`];
                }

                // Th·ª≠ t·∫£i t·ª´ cookies
                const cookies = document.cookie.split(';');
                const cookie = cookies.find(c => c.trim().startsWith(`${key}=`));
                if (cookie) {
                    const value = cookie.split('=')[1];
                    return JSON.parse(decodeURIComponent(value));
                }

                return null;
            } catch (error) {
                console.warn('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu:', error);
                return null;
            }
        }

        // H√†m l∆∞u t·∫•t c·∫£ d·ªØ li·ªáu
        function saveAllData() {
            saveData('computers', computers);
            saveData('history', history);
            saveData('totalBorrows', totalBorrows);
        }

        // C·∫≠p nh·∫≠t th·ªùi gian hi·ªán t·∫°i
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('vi-VN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        // Hi·ªÉn th·ªã th√¥ng b√°o
        function showAlert(message, type = 'success') {
            const alertContainer = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            alertContainer.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // C·∫≠p nh·∫≠t giao di·ªán
        function updateInterface() {
            // C·∫≠p nh·∫≠t tr·∫°ng th√°i m√°y t√≠nh
            for (let id in computers) {
                const computer = computers[id];
                const card = document.getElementById(`computer${id}`);
                const info = document.getElementById(`computer${id}-info`);
                const badge = card.querySelector('.status-badge');

                if (computer.available) {
                    card.className = 'computer-card available';
                    badge.className = 'status-badge status-available';
                    badge.textContent = 'S·∫µn s√†ng';
                    info.innerHTML = `
                        <p><strong>Tr·∫°ng th√°i:</strong> C√≥ th·ªÉ s·ª≠ d·ª•ng</p>
                        <p><strong>Ng∆∞·ªùi d√πng:</strong> Kh√¥ng c√≥</p>
                        <p><strong>Th·ªùi gian:</strong> --</p>
                    `;
                } else {
                    card.className = 'computer-card in-use';
                    badge.className = 'status-badge status-in-use';
                    badge.textContent = 'ƒêang d√πng';
                    info.innerHTML = `
                        <p><strong>Tr·∫°ng th√°i:</strong> ƒêang ƒë∆∞·ª£c s·ª≠ d·ª•ng</p>
                        <p><strong>Ng∆∞·ªùi d√πng:</strong> ${computer.borrower}</p>
                        <p><strong>Ph√≤ng ban:</strong> ${computer.department}</p>
                        <p><strong>Th·ªùi gian m∆∞·ª£n:</strong> ${computer.borrowTime}</p>
                        <p><strong>M·ª•c ƒë√≠ch:</strong> ${computer.purpose || 'Kh√¥ng c√≥'}</p>
                    `;
                }
            }

            // C·∫≠p nh·∫≠t dropdown tr·∫£ m√°y
            const returnSelect = document.getElementById('returnComputerSelect');
            returnSelect.innerHTML = '<option value="">-- Ch·ªçn m√°y t√≠nh --</option>';
            for (let id in computers) {
                if (!computers[id].available) {
                    const option = document.createElement('option');
                    option.value = id;
                    option.textContent = `M√°y t√≠nh #${id} (${computers[id].borrower})`;
                    returnSelect.appendChild(option);
                }
            }

            // C·∫≠p nh·∫≠t dropdown m∆∞·ª£n m√°y
            const borrowSelect = document.getElementById('computerSelect');
            const currentValue = borrowSelect.value;
            borrowSelect.innerHTML = '<option value="">-- Ch·ªçn m√°y t√≠nh --</option>';
            for (let id in computers) {
                if (computers[id].available) {
                    const option = document.createElement('option');
                    option.value = id;
                    option.textContent = `M√°y t√≠nh #${id}`;
                    borrowSelect.appendChild(option);
                }
            }

            // C·∫≠p nh·∫≠t th·ªëng k√™
            const availableCount = Object.values(computers).filter(c => c.available).length;
            const inUseCount = Object.values(computers).filter(c => !c.available).length;
            
            document.getElementById('totalBorrows').textContent = totalBorrows;
            document.getElementById('availableCount').textContent = availableCount;
            document.getElementById('inUseCount').textContent = inUseCount;

            // C·∫≠p nh·∫≠t b·∫£ng l·ªãch s·ª≠
            updateHistoryTable();
        }

        // C·∫≠p nh·∫≠t b·∫£ng l·ªãch s·ª≠ - ch·ªâ hi·ªÉn th·ªã 10 b·∫£n ghi g·∫ßn nh·∫•t
        function updateHistoryTable() {
            const tbody = document.getElementById('historyTableBody');
            tbody.innerHTML = '';
            
            // S·∫Øp x·∫øp l·ªãch s·ª≠ theo th·ªùi gian m·ªõi nh·∫•t v√† ch·ªâ l·∫•y 10 b·∫£n ghi ƒë·∫ßu
            const sortedHistory = [...history]
                .sort((a, b) => {
                    // Chuy·ªÉn ƒë·ªïi th·ªùi gian ƒë·ªÉ s·∫Øp x·∫øp ch√≠nh x√°c
                    const timeA = new Date(a.borrowTime.split(' ')[0].split('/').reverse().join('-') + ' ' + a.borrowTime.split(' ')[1]);
                    const timeB = new Date(b.borrowTime.split(' ')[0].split('/').reverse().join('-') + ' ' + b.borrowTime.split(' ')[1]);
                    return timeB - timeA; // S·∫Øp x·∫øp t·ª´ m·ªõi nh·∫•t ƒë·∫øn c≈© nh·∫•t
                })
                .slice(0, 10); // Ch·ªâ l·∫•y 10 b·∫£n ghi ƒë·∫ßu
            
            sortedHistory.forEach((record, index) => {
                const row = document.createElement('tr');
                // Th√™m class ƒë·ªÉ highlight b·∫£n ghi ƒëang s·ª≠ d·ª•ng
                if (!record.returnTime) {
                    row.style.backgroundColor = '#fff3cd';
                    row.style.fontWeight = 'bold';
                }
                
                row.innerHTML = `
                    <td>üíª M√°y t√≠nh #${record.computerId}</td>
                    <td>${record.borrower}</td>
                    <td>${record.department}</td>
                    <td>${record.borrowTime}</td>
                    <td>${record.returnTime || 'üîÑ ƒêang s·ª≠ d·ª•ng'}</td>
                    <td>${record.purpose || 'Kh√¥ng c√≥'}</td>
                    <td>
                        ${record.returnTime ? 
                            '<span style="color: #28a745; font-weight: bold;">‚úÖ ƒê√£ tr·∫£</span>' : 
                            '<span style="color: #dc3545; font-weight: bold;">üîÑ ƒêang s·ª≠ d·ª•ng</span>'
                        }
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Th√™m d√≤ng th√¥ng b√°o n·∫øu c√≥ nhi·ªÅu h∆°n 10 b·∫£n ghi
            if (history.length > 10) {
                const infoRow = document.createElement('tr');
                infoRow.style.backgroundColor = '#e9ecef';
                infoRow.style.fontStyle = 'italic';
                infoRow.innerHTML = `
                    <td colspan="7" style="text-align: center; padding: 15px;">
                        üìã Hi·ªÉn th·ªã 10 l·∫ßn m∆∞·ª£n g·∫ßn nh·∫•t. T·ªïng c·ªông c√≥ ${history.length} l·∫ßn m∆∞·ª£n trong h·ªá th·ªëng.
                    </td>
                `;
                tbody.appendChild(infoRow);
            }
        }

        // X·ª≠ l√Ω form m∆∞·ª£n m√°y
        document.getElementById('borrowForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const computerId = document.getElementById('computerSelect').value;
            const borrowerName = document.getElementById('borrowerName').value.trim();
            const department = document.getElementById('borrowerDepartment').value.trim();
            const purpose = document.getElementById('purpose').value.trim();

            if (!computerId || !borrowerName || !department) {
                showAlert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!', 'danger');
                return;
            }

            if (!computers[computerId].available) {
                showAlert('M√°y t√≠nh n√†y ƒëang ƒë∆∞·ª£c s·ª≠ d·ª•ng!', 'danger');
                return;
            }

            // C·∫≠p nh·∫≠t tr·∫°ng th√°i m√°y t√≠nh
            const borrowTime = new Date().toLocaleString('vi-VN');
            computers[computerId] = {
                available: false,
                borrower: borrowerName,
                borrowTime: borrowTime,
                purpose: purpose,
                department: department
            };

            // Th√™m v√†o l·ªãch s·ª≠
            history.push({
                computerId: computerId,
                borrower: borrowerName,
                department: department,
                borrowTime: borrowTime,
                purpose: purpose,
                returnTime: null
            });

            totalBorrows++;

            // Reset form
            this.reset();
            
            // L∆∞u d·ªØ li·ªáu sau khi thay ƒë·ªïi
            saveAllData();
            
            showAlert(`ƒê√£ ghi nh·∫≠n m∆∞·ª£n m√°y t√≠nh #${computerId} cho ${borrowerName}`, 'success');
            updateInterface();
        });

        // X·ª≠ l√Ω form tr·∫£ m√°y
        document.getElementById('returnForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const computerId = document.getElementById('returnComputerSelect').value;
            const notes = document.getElementById('returnNotes').value.trim();

            if (!computerId) {
                showAlert('Vui l√≤ng ch·ªçn m√°y t√≠nh c·∫ßn tr·∫£!', 'danger');
                return;
            }

            // C·∫≠p nh·∫≠t tr·∫°ng th√°i m√°y t√≠nh
            const borrowerName = computers[computerId].borrower;
            computers[computerId] = {
                available: true,
                borrower: null,
                borrowTime: null,
                purpose: null,
                department: null
            };

            // C·∫≠p nh·∫≠t l·ªãch s·ª≠
            const returnTime = new Date().toLocaleString('vi-VN');
            const historyRecord = history.find(record => 
                record.computerId === computerId && 
                record.borrower === borrowerName && 
                !record.returnTime
            );
            
            if (historyRecord) {
                historyRecord.returnTime = returnTime;
                if (notes) {
                    historyRecord.notes = notes;
                }
            }

            // Reset form
            this.reset();
            
            // L∆∞u d·ªØ li·ªáu sau khi thay ƒë·ªïi
            saveAllData();
            
            showAlert(`ƒê√£ ghi nh·∫≠n tr·∫£ m√°y t√≠nh #${computerId} t·ª´ ${borrowerName}`, 'success');
            updateInterface();
        });

        // Kh·ªüi t·∫°o
        function init() {
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            updateInterface();
            
            // L∆∞u d·ªØ li·ªáu ban ƒë·∫ßu
            saveAllData();
            
            // Hi·ªÉn th·ªã th√¥ng b√°o v·ªÅ t√¨nh tr·∫°ng l∆∞u d·ªØ li·ªáu
            setTimeout(() => {
                showAlert('‚úÖ H·ªá th·ªëng ƒë√£ s·∫µn s√†ng! D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông khi c√≥ thay ƒë·ªïi.', 'success');
            }, 1000);
        }

        // B·∫Øt ƒë·∫ßu ·ª©ng d·ª•ng
        init();

        // Th√™m c√°c h√†m qu·∫£n l√Ω d·ªØ li·ªáu
        function exportData() {
            const exportData = {
                computers: computers,
                history: history,
                totalBorrows: totalBorrows,
                exportTime: new Date().toLocaleString('vi-VN')
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `computer-checksheet-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showAlert('üì• ƒê√£ xu·∫•t d·ªØ li·ªáu th√†nh c√¥ng!', 'success');
        }

        function resetData() {
            if (confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc mu·ªën kh√¥i ph·ª•c d·ªØ li·ªáu m·∫´u? T·∫•t c·∫£ d·ªØ li·ªáu hi·ªán t·∫°i s·∫Ω b·ªã x√≥a!')) {
                computers = JSON.parse(JSON.stringify(defaultComputers));
                history = JSON.parse(JSON.stringify(defaultHistory));
                totalBorrows = defaultHistory.length;
                
                saveAllData();
                updateInterface();
                
                showAlert('üîÑ ƒê√£ kh√¥i ph·ª•c d·ªØ li·ªáu m·∫´u th√†nh c√¥ng!', 'success');
            }
        }
    </script>
</body>
</html>
